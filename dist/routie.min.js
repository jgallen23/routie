/*!
 * routie - a tiny hash router
 * v0.3.2
 * http://projects.jga.me/routie
 * copyright Greg Allen 2013
 * MIT License
*/
!function(a){var b=[],c={},d="routie",e=a[d],f=function(a,b){this.name=b,this.path=a,this.keys=[],this.fns=[],this.params={},this.regex=g(this.path,this.keys,!1,!1)};f.prototype.addHandler=function(a){this.fns.push(a)},f.prototype.removeHandler=function(a){for(var b=0,c=this.fns.length;c>b;b++){var d=this.fns[b];if(a==d)return this.fns.splice(b,1),void 0}},f.prototype.run=function(a){for(var b=0,c=this.fns.length;c>b;b++)this.fns[b].apply(this,a)},f.prototype.match=function(a,b){var c=this.regex.exec(a);if(!c)return!1;for(var d=1,e=c.length;e>d;++d){var f=this.keys[d-1],g="string"==typeof c[d]?decodeURIComponent(c[d]):c[d];f&&(this.params[f.name]=g),b.push(g)}return!0},f.prototype.toURL=function(a){var b=this.path;for(var c in a)b=b.replace("/:"+c,"/"+a[c]);if(b=b.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=b.indexOf(":"))throw new Error("missing parameters for url: "+b);return b};var g=function(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))},h=function(a,d){var e=a.split(" "),g=2==e.length?e[0]:null;a=2==e.length?e[1]:e[0],c[a]||(c[a]=new f(a,g),b.push(c[a])),c[a].addHandler(d)},i=function(a,b){if("function"==typeof b)h(a,b),i.reload();else if("object"==typeof a){for(var c in a)h(c,a[c]);i.reload()}else"undefined"==typeof b&&i.navigate(a)};i.lookup=function(a,c){for(var d=0,e=b.length;e>d;d++){var f=b[d];if(f.name==a)return f.toURL(c)}},i.remove=function(a,b){var d=c[a];d&&d.removeHandler(b)},i.removeAll=function(){c={},b=[]},i.restartListeners=function(){q(),p()},i.navigate=function(a,b){b=b||{};var c=b.silent||!1;c&&q(),setTimeout(function(){window.location.hash=a,c&&setTimeout(function(){p()},1)},1)},i.noConflict=function(){return a[d]=e,i};var j,k,l=function(){return window.location.hash.substring(1)},m=function(a,b){var c=[];return b.match(a,c)?(b.run(c),!0):!1},n=i.reload=function(){for(var a=l(),c=0,d=b.length;d>c;c++){var e=b[c];if(m(a,e))return}},o=50,p=function(){"onhashchange"in window?a.addEventListener?a.addEventListener("hashchange",n,!1):a.attachEvent("onhashchange",n):j=setInterval(function(){var a=window.location.hash;a!==k&&(n.call(window,{type:"hashchange",newHash:a,oldHash:k}),k=a)},o)},q=function(){"onhashchange"in window?a.removeEventListener?a.removeEventListener("hashchange",n):a.detachEvent("onhashchange",n):(clearInterval(j),k=void 0)};p(),a[d]=i}(window);